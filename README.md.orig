# Mustang
<<<<<<< HEAD
## Project 4 Objective
To utilize and train a machine learning model to predict outcomes based a dataset.

### Goal
To create and optimize the best machine learning model to predict the winning horse.

### Data Collection
Used 2 datasets from this website on horse-racing data around the world in the year 2020.
https://www.kaggle.com/datasets/hwaitt/horse-racing

### Data Cleaning
Merged the two datasets and dropped unecessary columns and rows with missing information. Utilized MongoDB and SQL to input the dataset into a database to further analyze the data with different tools.

### Attempted Machine Learning Models
Tested multiple machine learning models including Neural Network, Decision Tree, Random Forest, K-Nearest, etc. The machine leaning models used in the presentation were the models with the best outcomes. The models mentioned were Neural Networks and the Decision Tree.

### Presentation Slides
![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2010.23.09.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.12.30.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2010.24.01.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.12.12.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.14.30.png)

 In our dataset, we identified the top 10 features that greatly impact race outcomes. Among them, "ncond," which represents the condition type, emerges as a critical factor. Conditions such as weather, track surface, and race category can significantly influence a horse's performance, making it a key determinant in predicting race results.
Following closely is the "race class" feature, which reflects the competitiveness and prestige of a race. Higher-class races attract top-quality horses, leading to intense competition and potentially higher winning chances for skilled racehorses.
Another influential factor is the "jockey name." This feature indicates the jockey's ability to communicate effectively with the horse, strategize during the race, and make crucial decisions that can greatly influence the horse's performance.
While "runners" and "age" appeared towards the end of our top 10 features list, they should not be underestimated in their importance. "Runners" represent the total number of horses competing in a race, and it can have a significant impact on the dynamics of the race. Larger fields can lead to more crowded and unpredictable races, making it crucial for horses to maneuver effectively to secure a favorable position. Similarly, "age" plays a critical role in determining a horse's performance. Younger horses, such as 2-year-olds, may have the advantage of speed and potential, while 3-year-olds might have gained valuable racing experience. As horses age beyond 3, their physical abilities may start to decline, affecting their racing performance.

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2011.02.53.png)

In this chart, we explored the relationship between the "isfav" (Is Favorite) feature and race outcomes. The dark blue areas represent races where the horse was the favorite ("isfav" = 1) the lighter blue areas represent races where the horse positioned or not. The orange areas indicates where the horse win or not. In some cases the favourite horse may have performed well and placed, in some instanced our favourite horse is not even positioned or win. So this finding shows the while being the favourite horse improves the probability of winning and placing, but its not guarentee of victory in every race. Horses that are not the favourite can still emerge victorious. Therefore, while "isfav" is an important feature in predicting race outcomes, it is not the sole determinant of a horse's success. Additional factors such as age, race conditions, jockey expertise, and the overall quality of the competition also play pivotal roles in shaping the race results.

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2011.03.46.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2011.04.05.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2011.04.15.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.13.39.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2021.15.05.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.12.30.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.12.12.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-24%2020.14.30.png)

![Alt Text](https://github.com/hiromimiyata/Mustang/blob/main/Presentation_Slides/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202023-07-23%2011.06.03.png)
=======


# Horse Racing prediction model ( father_res_place.ipynb)


This repo contains a machine learning model that predicts the placement of horses in a race based on father's features. The model achieved an accuracy of 96% on the test set.



# Model
 
The prediction model is based on logistic regression, a supervised learning algorithm commonly used for binary classification problems. Logistic regression models the probability of the positive class (horse placed) based on the input feature.


To train the model, the dataset was preprocessed by performing one-hot encoding on the 'father' column and concatenating the encoded columns with the original dataframe. The dataset was then split into training and testing sets using a test size of 20%.

The logistic regression model was trained on the training set and achieved an accuracy of 96% on the test set. The accuracy metric measures the percentage of correctly predicted placements. The model performed well in distinguishing between placed and non-placed horses.


Confusion Matrix:
[[20785   871]
 [  210  8037]]

Classification Report:
              precision    recall  f1-score   support

         0.0       0.99      0.96      0.97     21656
         1.0       0.90      0.97      0.94      8247

    accuracy                           0.96     29903
   macro avg       0.95      0.97      0.96     29903
weighted avg       0.97      0.96      0.96     29903





From the confusion matrix, we can see that the model accurately predicted 20,785 non-placed horses (true negatives) and 8,037 placed horses (true positives). It also made 871 false positive predictions (non-placed horses predicted as placed) and 210 false negative predictions (placed horses predicted as non-placed).




# Conclusion: 

The horse racing prediction model based on logistic regression achieved an accuracy of 96% on the test set. It demonstrated strong performance in classifying whether a horse will be placed or not in a race. The confusion matrix provides additional insights into the model's performance, showing the distribution of correct and incorrect predictions based on father's features.








### Horse winning prediction model (horse_racing ipynb)



This model aims to predict whether a horse will win or not based on the names of its father and mother. We believe that the genetic information inherited from the horse's parents might impact its performance and speed.

How it Works:
We collected data on horses, including the names of their father and mother, as well as whether they won or not.(res_win)
Using machine learning techniques, we built two models: one using a decision tree algorithm and another using a neural network with multiple hidden layers.
The decision tree model achieved an accuracy of approximately 88%, while the neural network model achieved an accuracy of around 90%.
We evaluated the models using classification reports, which provide information on precision, recall, and F1-score.
Based on the classification reports, the models performed reasonably well in predicting winning horses, with precision ranging from 12% to 19% for the neural network model and 18% for the decision tree model.
The models were trained on a dataset that included information about the father and mother of each horse, allowing them to learn patterns and make predictions based on this genetic information.

Conclusion: 

Using the names of the horse's father and mother as features in the prediction models was an interesting approach to explore the potential genetic influence on racing ability. While the models achieved decent accuracy, predicting horse race outcomes only based solely on the names of their parents can be unreliable and needs to look at different factors as well such as track conditions, and past performance etc. 
>>>>>>> sunderiya
